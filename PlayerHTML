<!DOCTYPE html>
<html>
<head>
    <title>Player de Vídeo</title>
    <style>
        body {
            background-color: #f1f1f1;
            font-family: Arial, sans-serif;
        }

        .player-wrapper {
            max-width: 640px;
            margin: 20px auto;
            background-color: #000;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        video {
            width: 100%;
        }

        .progress-bar {
            width: 100%;
            height: 5px;
            background-color: #ccc;
        }

        .progress-bar-fill {
            height: 100%;
            background-color: #4CAF50;
            width: 0%;
        }

        .loading-bubble {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 5px solid #ccc;
            border-top-color: #4CAF50;
            animation: spin 1s linear infinite;
            z-index: 1;
        }

        @keyframes spin {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }
            100% {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <div class="player-wrapper">
        <div class="loading-bubble"></div>
        <video id="videoPlayer" controls>
            <source id="videoSource" src="" type="video/mp4">
            Seu navegador não suporta a tag de vídeo.
        </video>
        <div class="progress-bar">
            <div class="progress-bar-fill"></div>
        </div>
    </div>

    <script>
        window.onload = function() {
            var videoPlayer = document.getElementById("videoPlayer");
            var videoSource = document.getElementById("videoSource");
            var progressBarFill = document.querySelector(".progress-bar-fill");
            var loadingBubble = document.querySelector(".loading-bubble");

            var urlParam = new URLSearchParams(window.location.search).get("url");

            if (urlParam) {
                var supportedFormats = ["m3u", "m3u8", "mp4", "ts"];
                var formatMatched = false;

                for (var i = 0; i < supportedFormats.length; i++) {
                    var format = supportedFormats[i];

                    if (urlParam.endsWith("." + format)) {
                        videoSource.src = urlParam;
                        videoPlayer.load();
                        formatMatched = true;
                        break;
                    }
                }

                if (!formatMatched) {
                    console.error("Formato de vídeo não suportado!");
                }

                videoPlayer.addEventListener("loadedmetadata", function() {
                    loadingBubble.style.display = "none"; // Esconder a bolha de carregamento quando o vídeo estiver pronto para reproduzir

                    var duration = videoPlayer.duration;
                    var interval = setInterval(function() {
                        var progress = (videoPlayer.currentTime / duration) * 100;
                        progressBarFill.style.width = progress + "%";

                        if (progress >= 100) {
                            clearInterval(interval);
                        }
                    }, 500);
                });
            } else {
                videoSource.src = "default-video.mp4";
                videoPlayer.load();
            }
        };
    </script>
</body>
</html>
